# 온실가스 배출량 보고서 생성기

이 프로젝트는 python-docx 라이브러리를 사용하여 온실가스 배출량 보고서를 자동으로 생성하는 Python 스크립트입니다.

## 기능

- 사용자 입력을 통한 회사 정보 및 배출량 데이터 입력
- CSV 파일에서 배출량 데이터 자동 읽기
- 다양한 배출량 지표 자동 계산
- 표준화된 온실가스 배출량 보고서 생성
- 페이지 번호 자동 삽입
- 이미지 및 테이블 자동 삽입

## 필요한 파일

### 필수 CSV 파일들
- `Table1.csv`: 전체 배출량 데이터
- `Table2.csv`: 온실가스 종류별 GWP 정보
- `Table3.csv`: 조직 경계 정보
- `Table4.csv`: 운영 경계 정보
- `Table5.csv`: 사업장별 배출량
- `Table6.csv`: Scope별 배출량

### 이미지 파일
- `ci_logo.png`: 회사 로고 (표지 페이지용)
- `Chart1.png`: 사업장별 배출량 차트

### 환경 설정
- `.env`: OpenAI API 키 설정 (선택사항)

## 설치 및 실행

### 1. 의존성 설치
```bash
pip install -r requirements.txt
```

### 2. 환경 변수 설정 (선택사항)
`.env` 파일을 생성하고 OpenAI API 키를 설정합니다:
```
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. 스크립트 실행
```bash
python emission_report.py
```

## 사용법

스크립트 실행 시 다음 정보를 입력하라는 메시지가 나타납니다:

1. **회사명**: 보고서 대상 회사명
2. **사업장 수**: 총 사업장 개수
3. **보고대상연도**: 보고서 대상 연도
4. **기준연도**: 기준 연도
5. **보고대상연도 매출액**: 보고대상연도의 매출액 (백만원 단위)
6. **보고대상연도 임직원수**: 보고대상연도의 임직원 수
7. **전년도 매출액**: 전년도의 매출액 (백만원 단위)
8. **전년도 임직원수**: 전년도의 임직원 수

## 생성되는 보고서 내용

### 표지 페이지
- 회사 로고
- 보고서 제목 (한국어/영어)

### 본문
1. **배출량 산정 개요**
   - 배출량 산정기준
   - 배출량 개요
   - 전체 배출량 테이블
   - 사업장별 배출량 차트

2. **배출량 산정 상세내역**
   - 보고 대상 기간
   - 보고 대상 범위
   - 보고 대상 온실가스
   - 조직 경계
   - 운영 경계
   - 사업장별 온실가스 배출량
   - Scope별 온실가스 배출량

## 자동 계산되는 지표

- 전체 배출량 대비 기준연도/전년도 변동률
- Scope 1, 2, 3별 배출량 및 비율
- 최다 배출원 및 최다 배출 사업장
- 매출액 대비 배출량
- 임직원수 대비 배출량

## 출력 파일

스크립트 실행 완료 후 `{보고대상연도}년 온실가스 배출량 보고서.docx` 파일이 생성됩니다.

## 주의사항

- 모든 CSV 파일은 UTF-8 인코딩으로 저장되어야 합니다.
- CSV 파일의 컬럼명과 데이터 형식이 정확해야 합니다.
- 이미지 파일은 스크립트와 같은 디렉토리에 위치해야 합니다.

## 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다. 